# 礼物和SC测试功能说明

## 概述

现在你有两种方式来测试虚假礼物、醒目留言(SC)和大航海功能：

### 1. 通过 Console Input 插件发送单条测试消息 ⭐ **推荐**

### 2. 通过 Mock Danmaku 插件批量循环测试

---

## 方案一：Console Input 插件测试 (实时命令)

### 使用方法

1. **启动 Amaidesu 主程序**：确保 `console_input` 插件已启用
2. **在控制台输入命令**：

```bash
# 查看帮助
/help

# 发送礼物
/gift [用户名] [礼物名] [数量]

# 发送醒目留言
/sc [用户名] [内容...]

# 发送大航海开通
/guard [用户名] [等级]
```

### 命令示例

```bash
# 礼物测试（数量>1时会发送多个独立消息，每个消息间隔0.5秒）
/gift 大佬观众 火箭 1      # 发送1次火箭
/gift 土豪粉丝 辣条 5      # 连续发送5次辣条（5个独立消息）
/gift 连击玩家 爱心 10     # 连续发送10次爱心（10个独立消息）

# 醒目留言测试
/sc SC大佬 这是一条测试醒目留言！
/sc 打赏王 主播唱歌太好听了，求歌名！
/sc 土豪观众 今天状态不错，继续加油！

# 大航海测试
/guard 舰长大人 舰长
/guard 提督大佬 提督
/guard 总督爷 总督
```

### 特点
- ✅ **实时发送**：立即生效
- ✅ **灵活参数**：可自定义用户名、内容、数量
- ✅ **即时反馈**：控制台显示发送状态
- ✅ **真实模拟**：礼物数量>1时发送多个独立消息，每个消息间隔0.5秒
- ✅ **正确优先级**：
  - 礼物：VIP级别，优先级1（每个礼物都是单独的消息）
  - 醒目留言：超级VIP级别，优先级2  
  - 大航海：超级VIP级别，优先级3

---

## 方案二：Mock Danmaku 插件测试 (批量循环)

### 配置方法

1. **修改配置文件**：
```toml
# 编辑 src/plugins/mock_danmaku/config.toml
[mock_danmaku]
enabled = true
log_file_path = "test_gifts_and_sc.jsonl"  # 使用测试数据
send_interval = 3.0                        # 每3秒发送一条
loop_playback = true                       # 循环播放
start_immediately = true                   # 立即开始
```

2. **启动程序**：Mock Danmaku 插件会自动循环发送测试数据

### 包含的测试数据

- 5种不同礼物：辣条、小花花、火箭、爱心、盲盒
- 2条醒目留言测试
- 2种大航海开通：舰长、提督
- 1条普通弹幕对比

### 特点
- ✅ **自动循环**：无需手动操作
- ✅ **数据丰富**：包含各种类型的测试场景
- ✅ **持续测试**：可长时间运行验证系统稳定性

---

## 消息格式对比

| 消息类型 | 优先级 | 消息类型标记 | Segment 类型 |
|---------|--------|-------------|-------------|
| 普通弹幕 | 0 (normal) | normal | text |
| 礼物消息 | 1 (vip) | vip | gift + priority_info |
| 醒目留言 | 2 (super_vip) | super_vip | text + priority_info |
| 大航海 | 3 (super_vip) | super_vip | text + priority_info |

## 使用建议

1. **开发调试**：使用方案一，可以精确控制测试内容
2. **压力测试**：使用方案二，验证系统在连续消息下的表现
3. **功能验证**：两种方案结合使用，确保各种场景都能正常处理

## 注意事项

- 所有测试消息都标记为来自测试源，不会与真实消息混淆
- 用户ID采用哈希生成，确保每次运行的一致性
- 消息时间戳使用当前时间，符合实际场景
- 支持中文用户名和内容，测试多语言处理能力
- **礼物数量处理**：当礼物数量>1时，会发送对应数量的独立礼物消息，更真实地模拟用户连续送礼的行为 